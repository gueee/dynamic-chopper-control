# Dynamic Chopper Control (DCC) — Example Configuration
#
# Add this to your printer.cfg (or include it via [include]).
# Requires a matching [tmc5160 stepper_*] section for each stepper.
#
# DCC reads the motion planner's velocity profile and schedules timed
# TMC register writes at zone boundaries. Each zone carries a set of
# chopper field overrides — only specify fields you want to change
# from the static [tmc5160] config.
#
# Uses load_config_prefix, so any stepper name works:
#   [dynamic_chopper stepper_x]
#   [dynamic_chopper stepper_x1]
#   [dynamic_chopper stepper_y]
#   [dynamic_chopper stepper_y1]

# =====================================================================
# Shared zone profile reference (values are examples — tune per machine)
#
#   Zone 0:  0–80 mm/s    StealthChop, gentle PWM
#   Zone 1:  80–250 mm/s  SpreadCycle, mid-range
#   Zone 2:  250+ mm/s    SpreadCycle, high speed
# =====================================================================

[dynamic_chopper stepper_x]
enable: True
zone_velocities: 80, 250

# Zone 0: 0–80 mm/s — Low-speed StealthChop
zone_0_toff:          4
zone_0_hstrt:         4
zone_0_hend:          2
zone_0_tbl:           2
zone_0_tpfd:          1
zone_0_en_pwm_mode:   1

# Zone 1: 80–250 mm/s — SpreadCycle normal
zone_1_toff:          3
zone_1_hstrt:         4
zone_1_hend:          1
zone_1_tbl:           1
zone_1_tpfd:          1
zone_1_en_pwm_mode:   0

# Zone 2: 250+ mm/s — SpreadCycle high speed
zone_2_toff:          2
zone_2_hstrt:         5
zone_2_hend:          0
zone_2_tbl:           0
zone_2_tpfd:          0
zone_2_en_pwm_mode:   0

# Reversal profile — softens direction changes at 48V
reversal_toff:          5
reversal_hstrt:         2
reversal_hend:          4
reversal_tbl:           2
reversal_tpfd:          0
reversal_en_pwm_mode:   0
reversal_current_scale: 0.8
reversal_lead_time:     0.0005
reversal_hold_time:     0.001

spi_lead_time:          0.00001


[dynamic_chopper stepper_x1]
enable: True
zone_velocities: 80, 250

zone_0_toff:          4
zone_0_hstrt:         4
zone_0_hend:          2
zone_0_tbl:           2
zone_0_tpfd:          1
zone_0_en_pwm_mode:   1

zone_1_toff:          3
zone_1_hstrt:         4
zone_1_hend:          1
zone_1_tbl:           1
zone_1_tpfd:          1
zone_1_en_pwm_mode:   0

zone_2_toff:          2
zone_2_hstrt:         5
zone_2_hend:          0
zone_2_tbl:           0
zone_2_tpfd:          0
zone_2_en_pwm_mode:   0

reversal_toff:          5
reversal_hstrt:         2
reversal_hend:          4
reversal_tbl:           2
reversal_tpfd:          0
reversal_en_pwm_mode:   0
reversal_current_scale: 0.8
reversal_lead_time:     0.0005
reversal_hold_time:     0.001

spi_lead_time:          0.00001


[dynamic_chopper stepper_y]
enable: True
zone_velocities: 80, 250

zone_0_toff:          4
zone_0_hstrt:         4
zone_0_hend:          2
zone_0_tbl:           2
zone_0_tpfd:          1
zone_0_en_pwm_mode:   1

zone_1_toff:          3
zone_1_hstrt:         4
zone_1_hend:          1
zone_1_tbl:           1
zone_1_tpfd:          1
zone_1_en_pwm_mode:   0

zone_2_toff:          2
zone_2_hstrt:         5
zone_2_hend:          0
zone_2_tbl:           0
zone_2_tpfd:          0
zone_2_en_pwm_mode:   0

reversal_toff:          5
reversal_hstrt:         2
reversal_hend:          4
reversal_tbl:           2
reversal_tpfd:          0
reversal_en_pwm_mode:   0
reversal_current_scale: 0.8
reversal_lead_time:     0.0005
reversal_hold_time:     0.001

spi_lead_time:          0.00001


[dynamic_chopper stepper_y1]
enable: True
zone_velocities: 80, 250

zone_0_toff:          4
zone_0_hstrt:         4
zone_0_hend:          2
zone_0_tbl:           2
zone_0_tpfd:          1
zone_0_en_pwm_mode:   1

zone_1_toff:          3
zone_1_hstrt:         4
zone_1_hend:          1
zone_1_tbl:           1
zone_1_tpfd:          1
zone_1_en_pwm_mode:   0

zone_2_toff:          2
zone_2_hstrt:         5
zone_2_hend:          0
zone_2_tbl:           0
zone_2_tpfd:          0
zone_2_en_pwm_mode:   0

reversal_toff:          5
reversal_hstrt:         2
reversal_hend:          4
reversal_tbl:           2
reversal_tpfd:          0
reversal_en_pwm_mode:   0
reversal_current_scale: 0.8
reversal_lead_time:     0.0005
reversal_hold_time:     0.001

spi_lead_time:          0.00001
